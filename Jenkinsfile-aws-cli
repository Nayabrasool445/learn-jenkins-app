pipeline {
    agent any

    stages {
        stage('Building Images') {
            agent{
                docker{
                    image 'amazon/aws-cli'
                    reuseNode true
                    args "-u root -v /var/run/docker.sock:/var/run/docker.sock --entrypoint=''"
                }
            }
            steps {
                sh '''
                amazon-linux-extras install docker
                docker --version
                docker build -f AWS/Dockerfile-aws-cli -t my-aws-cli . 
                '''
            }
        }
    }
}


